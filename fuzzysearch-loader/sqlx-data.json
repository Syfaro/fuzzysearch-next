{
  "db": "PostgreSQL",
  "16a9c86dd416a568464b169d454c7fb87ef9f8a2fb0ec0fd9f664d7856a6ebff": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Jsonb"
        ]
      }
    },
    "query": "INSERT INTO submission_artist (submission_id, artist_id)\n    SELECT * FROM jsonb_to_recordset($1)\n        AS submission_artist (submission_id uuid, artist_id uuid)\n    ON CONFLICT DO NOTHING;\n"
  },
  "18968491e20014ee149180899a0a1abf121d294dbf472ee525b49d25d0f6787e": {
    "describe": {
      "columns": [
        {
          "name": "one",
          "ordinal": 0,
          "type_info": "Int4"
        }
      ],
      "nullable": [
        null
      ],
      "parameters": {
        "Left": [
          "Text"
        ]
      }
    },
    "query": "SELECT 1 one FROM submission WHERE site = 'FurAffinity' AND site_submission_id = $1"
  },
  "26606ad0cd1785a0ebcaf987af034956733ba00df5b245c91db4f4899eaaca1a": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Text",
          "Text",
          "Text",
          "Text"
        ]
      }
    },
    "query": "insert into\n    artist (site, site_artist_id, display_name, link)\nvalues\n    ($1::text::site, $2, $3, $4) ON CONFLICT (site, site_artist_id)\n        do update set display_name = excluded.display_name, link = excluded.link\n    returning id;\n"
  },
  "2a08b4c870530a26c324cfdfb61bfe7afb1be6689232b79880b51e2849dce5c9": {
    "describe": {
      "columns": [
        {
          "name": "site_submission_id",
          "ordinal": 0,
          "type_info": "Int8"
        }
      ],
      "nullable": [
        null
      ],
      "parameters": {
        "Left": []
      }
    },
    "query": "SELECT site_submission_id::bigint FROM submission WHERE site = 'FurAffinity'"
  },
  "592059e67a74c1aad6038aa03b9d40bf2773a8bf0de9a3a7b14a0143f7b364a7": {
    "describe": {
      "columns": [
        {
          "name": "id!",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "site!",
          "ordinal": 1,
          "type_info": "Text"
        },
        {
          "name": "site_submission_id!",
          "ordinal": 2,
          "type_info": "Text"
        },
        {
          "name": "link!",
          "ordinal": 3,
          "type_info": "Text"
        },
        {
          "name": "title",
          "ordinal": 4,
          "type_info": "Text"
        },
        {
          "name": "description",
          "ordinal": 5,
          "type_info": "Text"
        },
        {
          "name": "rating",
          "ordinal": 6,
          "type_info": "Text"
        },
        {
          "name": "posted_at",
          "ordinal": 7,
          "type_info": "Timestamptz"
        },
        {
          "name": "tags",
          "ordinal": 8,
          "type_info": "TextArray"
        },
        {
          "name": "deleted!",
          "ordinal": 9,
          "type_info": "Bool"
        },
        {
          "name": "retrieved_at",
          "ordinal": 10,
          "type_info": "Timestamptz"
        },
        {
          "name": "extra",
          "ordinal": 11,
          "type_info": "Jsonb"
        },
        {
          "name": "artists: sqlx::types::Json<Vec<fuzzysearch_common::Artist>>",
          "ordinal": 12,
          "type_info": "Jsonb"
        },
        {
          "name": "media: sqlx::types::Json<Vec<fuzzysearch_common::Media>>",
          "ordinal": 13,
          "type_info": "Jsonb"
        }
      ],
      "nullable": [
        true,
        null,
        true,
        true,
        true,
        true,
        null,
        true,
        true,
        true,
        true,
        true,
        true,
        true
      ],
      "parameters": {
        "Left": [
          "Jsonb"
        ]
      }
    },
    "query": "with search_query as (\n\tselect\n\t\tquery.site,\n\t\tquery.site_submission_id\n\tfrom jsonb_to_recordset($1) AS query (site site, site_submission_id text)\n)\nselect distinct on (submission_detail.site, submission_detail.site_submission_id)\n\tsubmission_detail.id \"id!\",\n\tsubmission_detail.site::text \"site!\",\n\tsubmission_detail.site_submission_id \"site_submission_id!\",\n\tsubmission_detail.link \"link!\",\n\tsubmission_detail.title,\n\tsubmission_detail.description,\n\tsubmission_detail.rating::text,\n\tsubmission_detail.posted_at,\n\tsubmission_detail.tags,\n\tsubmission_detail.deleted \"deleted!\",\n\tsubmission_detail.retrieved_at,\n\tsubmission_detail.extra,\n\tsubmission_detail.artists \"artists: sqlx::types::Json<Vec<fuzzysearch_common::Artist>>\",\n\tsubmission_detail.media \"media: sqlx::types::Json<Vec<fuzzysearch_common::Media>>\"\nfrom search_query\n\tjoin submission_detail on submission_detail.site = search_query.site and submission_detail.site_submission_id = search_query.site_submission_id\norder by\n\tsubmission_detail.site,\n\tsubmission_detail.site_submission_id,\n\tsubmission_detail.retrieved_at desc nulls last;\n"
  },
  "7605aa76402531bcdc1257f4937b615fe431d3d4a0431fa5f99f6944bf5abb2d": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Jsonb"
        ]
      }
    },
    "query": "INSERT INTO media_frame (media_id, frame_index, perceptual_gradient)\n    SELECT * FROM jsonb_to_recordset($1)\n        AS frame (media_id uuid, frame_index bigint, perceptual_gradient bigint)\n    ON CONFLICT DO NOTHING;\n"
  },
  "7debadb757ba05af264ce7664d064d43d2c72a6798e287c81766c689a9ccd453": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          "Uuid",
          "Text",
          "Text",
          "Jsonb"
        ]
      }
    },
    "query": "INSERT INTO submission_media (submission_id, media_id, site_media_id, url, extra)\n    VALUES ($1, $2, $3, $4, $5)\n    ON CONFLICT DO NOTHING\n    RETURNING id;\n"
  },
  "8479d8aef7f5ce7666a1fc1c3f371a9d0c787211ede862f07298f0dd97b7b732": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Text",
          "Text",
          "Bool",
          "Timestamptz",
          "Text",
          "Text",
          "TextArray",
          "Text",
          "Text",
          "Timestamptz",
          "Jsonb"
        ]
      }
    },
    "query": "insert into submission (site, site_submission_id, deleted, posted_at, link, title, tags, description, rating, retrieved_at, extra)\n    values ($1::text::site, $2, $3, $4, $5, $6, $7, $8, $9::text::rating, $10, $11)\n    on conflict do nothing\n    returning id;\n"
  },
  "84f2ab252ce12a7cd21d81f05ba0106c873774db1929f79f8808a55715e492e4": {
    "describe": {
      "columns": [
        {
          "name": "max",
          "ordinal": 0,
          "type_info": "Int8"
        }
      ],
      "nullable": [
        null
      ],
      "parameters": {
        "Left": []
      }
    },
    "query": "SELECT max(site_submission_id::bigint) FROM submission WHERE site = 'FurAffinity' AND deleted = false"
  },
  "b5b38a85243c239b83b1ceb270e92a701d708bd6a02c9c45c1a03961c95d234a": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Bytea",
          "Int8",
          "Text",
          "Bool"
        ]
      }
    },
    "query": "INSERT INTO\n    media (file_sha256, file_size, mime_type, single_frame)\nVALUES\n    ($1, $2, $3, $4) ON CONFLICT DO NOTHING RETURNING id;\n"
  },
  "c2ddab265813d0454291a35b09c1f1f7a16889912266103217cbf8cfaf7e89fd": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Bytea"
        ]
      }
    },
    "query": "SELECT\n    id\nFROM\n    media\nWHERE\n    file_sha256 IS NOT NULL\n    AND file_sha256 = $1;\n"
  },
  "d0f210d1e87912aae656e30a566ed07efc2448350a68bcd4edd15b16ad36d9a0": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "perceptual_gradients",
          "ordinal": 1,
          "type_info": "Int8Array"
        }
      ],
      "nullable": [
        false,
        null
      ],
      "parameters": {
        "Left": [
          "Bytea"
        ]
      }
    },
    "query": "SELECT\n    media.id,\n    array_agg(media_frame.perceptual_gradient ORDER BY media_frame.frame_index) perceptual_gradients\nFROM\n    media\n    JOIN media_frame ON media_frame.media_id = media.id\nWHERE\n    file_sha256 IS NOT NULL\n    AND file_sha256 = $1\nGROUP BY\n    1;\n"
  },
  "ede9e928e898efc94a352692e6045033f7bf685b10733c16d98418209652aec2": {
    "describe": {
      "columns": [
        {
          "name": "site!",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "site_submission_id!",
          "ordinal": 1,
          "type_info": "Text"
        }
      ],
      "nullable": [
        null,
        false
      ],
      "parameters": {
        "Left": [
          "Int8Array"
        ]
      }
    },
    "query": "select\n\tdistinct on (submission.site, submission.site_submission_id)\n\tsubmission.site::text \"site!\",\n\tsubmission.site_submission_id \"site_submission_id!\"\nfrom\n\tmedia_frame\n\tjoin submission_media on submission_media.media_id = media_frame.media_id\n    join media on media.id = submission_media.media_id\n\tjoin submission on submission.id = submission_media.submission_id\nwhere\n\tmedia_frame.perceptual_gradient = any($1)\n\tand media_frame.perceptual_gradient is not null\n    and media.single_frame = true\norder by\n\tsubmission.site,\n\tsubmission.site_submission_id,\n\tsubmission.retrieved_at desc nulls last;\n"
  }
}